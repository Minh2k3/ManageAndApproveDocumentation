import{u as R}from"./use-menu-BgazaTml.js";import{_ as V,e as $,c as p,b as y,d as l,r as f,F as b,g as w,z as N,i as E,D as P,o as a,a as s,N as v,u as U,E as K,q as i,x as c,I as u}from"./index-CqN3-FrM.js";import{u as M}from"./document-store-Bqat0f0E.js";const O=$({setup(){const n=w("1");R().onSelectedKeys(["approver-documents"]);const t=M(),B=N(),A=w([]),C=w([]);E(async()=>{await t.fetchDocuments(B.user.id),A.value=t.documents.documents_need_me,C.value=t.documents.documents_of_me});const T=[{title:"Tên văn bản",key:"title",dataIndex:"title",width:200,sorter:(o,d)=>o.title.localeCompare(d.title),sortDirections:["ascend","descend"],customHeaderCell:()=>({style:{textAlign:"center"}})},{title:"Loại văn bản",key:"type",dataIndex:"type",width:150,sorter:(o,d)=>o.type.localeCompare(d.type),sortDirections:["ascend","descend"],customHeaderCell:()=>({style:{textAlign:"center"}})},{title:"Người đề xuất",key:"creator_name",dataIndex:"creator_name",width:200,sorter:(o,d)=>o.creator_name.localeCompare(d.creator_name),sortDirections:["ascend","descend"],align:"center"},{title:"Trạng thái",key:"status",dataIndex:"status",width:120,sorter:(o,d)=>{const e={in_review:1,pending:2,approved:3,rejected:4};return e[o.status]-e[d.status]},sortDirections:["ascend","descend"],align:"center"},{title:"Ngày tạo",key:"created_at",dataIndex:"created_at",width:150,sorter:(o,d)=>{const e=o.created_at.split(" ")[1].split("/").reverse().join("-")+" "+o.created_at.split(" ")[0],m=d.created_at.split(" ")[1].split("/").reverse().join("-")+" "+d.created_at.split(" ")[0];return e.localeCompare(m)},sortDirections:["ascend","descend"],align:"center"},{title:"Lần duyệt cuối",key:"updated_at",dataIndex:"updated_at",width:150,sorter:(o,d)=>{const e=o.updated_at.split(" ")[1].split("/").reverse().join("-")+" "+o.updated_at.split(" ")[0],m=d.updated_at.split(" ")[1].split("/").reverse().join("-")+" "+d.updated_at.split(" ")[0];return e.localeCompare(m)},sortDirections:["ascend","descend"],align:"center"}],S=[{title:"Tên văn bản",key:"title",dataIndex:"title",width:200,sorter:(o,d)=>o.title.localeCompare(d.title),sortDirections:["ascend","descend"],customHeaderCell:()=>({style:{textAlign:"center"}})},{title:"Loại văn bản",key:"type",dataIndex:"type",width:150,sorter:(o,d)=>o.type.localeCompare(d.type),sortDirections:["ascend","descend"],customHeaderCell:()=>({style:{textAlign:"center"}})},{title:"Người đề xuất",key:"creator_name",dataIndex:"creator_name",width:200,sorter:(o,d)=>o.creator_name.localeCompare(d.creator_name),sortDirections:["ascend","descend"],align:"center"},{title:"Trạng thái",key:"status",dataIndex:"status",width:120,sorter:(o,d)=>{const e={draft:1,in_review:2,approved:3,rejected:4};return e[o.status]-e[d.status]},sortDirections:["ascend","descend"],align:"center"},{title:"Ngày tạo",key:"created_at",dataIndex:"created_at",width:150,sorter:(o,d)=>{const e=o.created_at.split(" ")[1].split("/").reverse().join("-")+" "+o.created_at.split(" ")[0],m=d.created_at.split(" ")[1].split("/").reverse().join("-")+" "+d.created_at.split(" ")[0];return e.localeCompare(m)},sortDirections:["ascend","descend"],align:"center"},{title:"Lần duyệt cuối",key:"updated_at",dataIndex:"updated_at",width:150,sorter:(o,d)=>{const e=o.updated_at.split(" ")[1].split("/").reverse().join("-")+" "+o.updated_at.split(" ")[0],m=d.updated_at.split(" ")[1].split("/").reverse().join("-")+" "+d.updated_at.split(" ")[0];return e.localeCompare(m)},sortDirections:["ascend","descend"],align:"center"}],k=P(),D=o=>o.process+"/"+o.step_count+" bước",g=w(!1),h=w({}),_=o=>{h.value=o,g.value=!0,console.log(h.value.id)};return{apiUrl:"https://tminh.id.vn",documents_need_me:A,documents_of_me:C,columns_need_me:T,columns_of_me:S,activeKey:n,detailVisible:g,selectedDocument:h,customRow:o=>({onClick:()=>{_(o)},style:{cursor:"pointer"}}),showProcess:D,goToEditPage:o=>{k.push(`documents/${o}/edit`)},goToDetailPage:o=>{k.push({name:"approver-documents-detail",params:{id:o},query:{from_me:n.value==="1"?"1":"0"}})}}}}),Q={class:"row my-3"},H={class:"d-flex justify-content-end align-items-center"},q={class:"row mb-3"},z=["onClick","onMouseover"],F={class:"d-flex justify-content-between align-items-center"},J={class:"fw-bold fs-6"},W={class:"fw-bold fs-3"},X={class:"row mb-3"},G={class:"d-flex flex-wrap gap-2 w-100 align-items-center"},Y={class:"flex-grow-1",style:{"min-width":"250px"}},Z={class:"d-flex gap-2 flex-wrap justify-content-end ms-auto"},ee={class:"row"},te={class:"col-12"},se={key:0},ne={class:""},oe={key:0,class:"bg-primary text-white p-1 rounded rounded-1 border border-1"},ae={key:1,class:"bg-warning text-white p-1 rounded rounded-1 border border-1"},le={key:2,class:"bg-success text-white p-1 rounded rounded-1 border border-1"},de={key:0,class:"text-secondary"},ie={key:1,class:"text-primary"},re={key:2,class:"text-success"},pe={key:3,class:"text-danger"},ue={class:"row"},ce={class:"col-12"},ye={key:0},_e={class:""},me={key:2,class:""},fe={class:""},ve={key:0},ke={key:0,class:"text-secondary"},ge={key:1,class:"text-primary"},he={key:2,class:"text-success"},we={key:3,class:"text-danger"},be={key:1},Ae={key:2},Ce=["href"];function Se(n,t,B,A,C,T){const S=f("router-link"),k=f("a-button"),D=f("a-input-search"),g=f("a-select"),h=f("a-empty"),_=f("a-tooltip"),x=f("a-table"),j=f("a-tab-pane"),I=f("a-tabs"),L=f("a-card"),o=f("a-divider"),d=f("a-modal");return a(),p(b,null,[y(L,{title:"",style:{width:"100%"}},{default:l(()=>[t[15]||(t[15]=s("h2",{class:"fw-bold mb-3"},"Quản Lý Văn Bản",-1)),s("div",Q,[s("div",H,[y(k,{type:"primary",class:"col-6 col-sm-4"},{default:l(()=>[y(S,{to:"documents/create",class:"text-decoration-none"},{default:l(()=>t[8]||(t[8]=[s("i",{class:"fa-solid fa-add me-2"},null,-1),v("Tạo văn bản mới ")])),_:1})]),_:1})])]),s("div",q,[(a(!0),p(b,null,U(n.statusList,e=>(a(),p("div",{key:e.key,class:"col-5 col-md mb-2 mb-md-0 border rounded-2 mx-2 p-3 cursor-pointer",style:K({backgroundColor:n.selectedStatus===e.key?e.color:n.hovered===e.key?"#f0f0f0":"#ffffff",borderColor:n.selectedStatus===e.key||n.hovered===e.key?e.borderColor:"#dee2e6",borderWidth:"2px",borderStyle:"solid",color:n.selectedStatus===e.key?"#fff":"#000",transition:"0.2s"}),onClick:m=>n.selectedStatus=e.key,onMouseover:m=>n.hovered=e.key,onMouseleave:t[0]||(t[0]=m=>n.hovered=null)},[s("div",F,[s("span",J,i(e.label),1),s("span",W,i(e.count),1)])],44,z))),128))]),s("div",X,[s("div",G,[s("div",Y,[y(D,{placeholder:"Tìm kiếm","allow-clear":"","enter-button":"",class:"w-100"})]),s("div",Z,[y(g,{class:"col",value:n.status_id,"onUpdate:value":t[1]||(t[1]=e=>n.status_id=e),"show-search":"",placeholder:"Trạng thái",options:n.documents_status,"filter-option":n.filterOption,"allow-clear":"",style:{"min-width":"150px"}},null,8,["value","options","filter-option"]),y(g,{class:"col",value:n.type_id,"onUpdate:value":t[2]||(t[2]=e=>n.type_id=e),"show-search":"",placeholder:"Loại văn bản",options:n.documents_type,"filter-option":n.filterOption,"allow-clear":"",style:{"min-width":"150px"}},null,8,["value","options","filter-option"]),y(g,{class:"col",value:n.department_id,"onUpdate:value":t[3]||(t[3]=e=>n.department_id=e),"show-search":"",placeholder:"Đơn vị đề xuất",options:n.documents_creator,"filter-option":n.filterOption,"allow-clear":"",style:{"min-width":"150px"}},null,8,["value","options","filter-option"]),y(k,{class:"col",type:"primary"},{default:l(()=>t[9]||(t[9]=[s("i",{class:"fa-solid fa-filter"},null,-1)])),_:1})])])]),y(I,{activeKey:n.activeKey,"onUpdate:activeKey":t[4]||(t[4]=e=>n.activeKey=e),type:"card",class:"row"},{default:l(()=>[y(j,{key:"1",tab:"Văn bản gửi đi"},{default:l(()=>[s("div",ee,[s("div",te,[n.documents_of_me.length===0?(a(),c(h,{key:0,image:"https://gw.alipayobjects.com/mdn/miniapp_social/afts/img/A*pevERLJC9v0AAAAAAAAAAABjAQAAAQ/original","image-style":{height:"60px"}},{description:l(()=>t[10]||(t[10]=[s("span",null," Bạn thuộc dạng đẳng cấp nên chả cần tạo văn bản phê duyệt nhỉ. ",-1)])),default:l(()=>[y(k,{type:"primary"},{default:l(()=>t[11]||(t[11]=[v("Bấm nếu bạn cần")])),_:1})]),_:1})):(a(),c(x,{key:1,dataSource:n.documents_of_me,columns:n.columns_of_me,scroll:{x:576},bordered:"",customRow:n.customRow,showSorterTooltip:!1},{headerCell:l(({column:e})=>[e.key==="title"?(a(),c(_,{key:0,title:"Sắp xếp theo tên văn bản"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="type"?(a(),c(_,{key:1,title:"Sắp xếp theo loại văn bản"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="status"?(a(),c(_,{key:2,title:"Sắp xếp theo trạng thái"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="created_at"?(a(),c(_,{key:3,title:"Sắp xếp theo ngày tạo"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="updated_at"?(a(),c(_,{key:4,title:"Sắp xếp theo ngày cập nhật"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):u("",!0)]),bodyCell:l(({column:e,index:m,record:r})=>[e.key==="index"?(a(),p("span",se,i(m+1),1)):u("",!0),e.key==="creator_name"?(a(),c(_,{key:1},{title:l(()=>[s("span",ne,i(r.roll),1)]),default:l(()=>[s("span",null,i(r.creator_name),1)]),_:2},1024)):u("",!0),e.key==="type"?(a(),p(b,{key:2},[r.type_id==1?(a(),p("span",oe,i(r.type),1)):u("",!0),r.type_id==2?(a(),p("span",ae,i(r.type),1)):u("",!0),r.type_id==3?(a(),p("span",le,i(r.type),1)):u("",!0)],64)):u("",!0),e.key==="status"?(a(),p(b,{key:3},[r.status==="draft"?(a(),p("span",de,"Bản nháp")):u("",!0),r.status==="in_review"?(a(),p("span",ie,"Chờ duyệt")):u("",!0),r.status==="approved"?(a(),p("span",re,"Đã duyệt")):u("",!0),r.status==="rejected"?(a(),p("span",pe,"Bị từ chối")):u("",!0)],64)):u("",!0)]),_:1},8,["dataSource","columns","customRow"]))])])]),_:1}),y(j,{key:"2",tab:"Văn bản đến tôi","force-render":""},{default:l(()=>[s("div",ue,[s("div",ce,[n.documents_need_me.length===0?(a(),c(h,{key:0,image:"https://gw.alipayobjects.com/mdn/miniapp_social/afts/img/A*pevERLJC9v0AAAAAAAAAAABjAQAAAQ/original","image-style":{height:"60px"}},{description:l(()=>t[12]||(t[12]=[s("span",null," Có quyền phê duyệt mà đếch ai cần đến bạn, tội ghê gớm! ",-1)])),_:1})):(a(),c(x,{key:1,dataSource:n.documents_need_me,columns:n.columns_need_me,scroll:{x:576},bordered:"",customRow:n.customRow,showSorterTooltip:!1},{headerCell:l(({column:e})=>[e.key==="title"?(a(),c(_,{key:0,title:"Sắp xếp theo tên văn bản"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="type"?(a(),c(_,{key:1,title:"Sắp xếp theo loại văn bản"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="status"?(a(),c(_,{key:2,title:"Sắp xếp theo trạng thái"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="created_at"?(a(),c(_,{key:3,title:"Sắp xếp theo ngày tạo"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):e.key==="updated_at"?(a(),c(_,{key:4,title:"Sắp xếp theo ngày cập nhật"},{default:l(()=>[s("span",null,i(e.title),1)]),_:2},1024)):u("",!0)]),bodyCell:l(({column:e,index:m,record:r})=>[e.key==="index"?(a(),p("span",ye,i(m+1),1)):u("",!0),e.key==="creator_name"?(a(),c(_,{key:1},{title:l(()=>[s("span",_e,i(r.roll),1)]),default:l(()=>[s("span",null,i(r.creator_name),1)]),_:2},1024)):u("",!0),e.key==="type"?(a(),p("span",me,i(r.type),1)):u("",!0),e.key==="status"?(a(),c(_,{key:3},{title:l(()=>[s("span",fe,i(n.showProcess(r)),1)]),default:l(()=>[r.document_status==="in_review"?(a(),p("div",ve,[r.step_status==="pending"?(a(),p("span",ke,"Chưa tới bạn")):u("",!0),r.step_status==="in_review"?(a(),p("span",ge,"Chờ bạn duyệt")):u("",!0),r.step_status==="approved"?(a(),p("span",he,"Bạn đã duyệt")):u("",!0),r.step_status==="rejected"?(a(),p("span",we,"Bạn từ chối")):u("",!0)])):r.document_status==="approved"?(a(),p("div",be,t[13]||(t[13]=[s("span",{class:"text-success"},"Đã được duyệt",-1)]))):r.document_status==="rejected"?(a(),p("div",Ae,t[14]||(t[14]=[s("span",{class:"text-danger"},"Bị từ chối",-1)]))):u("",!0)]),_:2},1024)):u("",!0)]),_:1},8,["dataSource","columns","customRow"]))])])]),_:1})]),_:1},8,["activeKey"])]),_:1}),y(d,{open:n.detailVisible,"onUpdate:open":t[7]||(t[7]=e=>n.detailVisible=e),width:"600px","z-index":"10000"},{footer:l(()=>[y(k,{onClick:t[5]||(t[5]=e=>n.detailVisible=!1)},{default:l(()=>t[24]||(t[24]=[v("Đóng")])),_:1}),y(k,{type:"primary",onClick:t[6]||(t[6]=e=>n.goToDetailPage(n.selectedDocument.id))},{default:l(()=>t[25]||(t[25]=[v("Chi tiết")])),_:1})]),default:l(()=>[s("div",null,[t[23]||(t[23]=s("h5",null,"📄 Thông tin văn bản",-1)),s("p",null,[t[16]||(t[16]=s("strong",null,"Tiêu đề:",-1)),v(" "+i(n.selectedDocument.title),1)]),s("p",null,[t[17]||(t[17]=s("strong",null,"Mô tả:",-1)),v(" "+i(n.selectedDocument.description),1)]),s("p",null,[t[18]||(t[18]=s("strong",null,"Loại văn bản:",-1)),v(" "+i(n.selectedDocument.type),1)]),s("p",null,[t[19]||(t[19]=s("strong",null,"Số lượng phiên bản:",-1)),v(" "+i(n.selectedDocument.version_count),1)]),s("p",null,[t[20]||(t[20]=s("strong",null,"Ngày tạo:",-1)),v(" "+i(n.selectedDocument.created_at),1)]),s("p",null,[t[21]||(t[21]=s("strong",null,"Ngày cập nhật:",-1)),v(" "+i(n.selectedDocument.updated_at),1)]),s("p",null,[t[22]||(t[22]=s("strong",null,"Tệp:",-1)),s("a",{href:`${n.apiUrl}/documents/${n.selectedDocument.file_path}`,target:"_blank"}," Xem tệp ",8,Ce)]),y(o)])]),_:1},8,["open"])],64)}const Be=V(O,[["render",Se]]);export{Be as default};
