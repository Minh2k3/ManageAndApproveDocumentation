import{_ as z,e as B,c as d,a as s,b as m,d as n,r as D,N as a,q as i,n as h,F as I,u as K,z as V,A as F,U as L,g as k,C as $,i as j,H as A,D as E,o as r,I as C}from"./index-qeq2zkB_.js";import{u as M}from"./use-menu-vCLX-e5I.js";import{u as q}from"./department-store-EFablhex.js";const H=B({setup(){const t=E(),e=L();V();const y=q(),_=F();M().onSelectedKeys(["admin-approval-flows-template"]);const w=e.params.id;console.log("Template ID:",w);const b=k(!0),l=k([]),c=$(()=>l.value.find(o=>o.id==w)||{}),u=k([]);j(async()=>{try{await y.fetchDepartments(),u.value=y.departments,console.log("Danh sách đơn vị:",u.value),await _.fetchDocumentFlowTemplates(),l.value=_.document_flow_templates,console.log("Danh sách luồng mẫu:",l.value),b.value=!1}catch(o){console.error("Lỗi khi tải dữ liệu:",o),A.error("Đã xảy ra lỗi khi tải thông tin luồng mẫu"),b.value=!1}});function g(o){if(!o)return"N/A";const v=new Date(o);return new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(v)}function p(o){const v=u.value.find(S=>S.id===o);return v?v.name:"Không xác định"}function f(){t.push({name:"admin-approval-flows"})}function T(){console.log("Chỉnh sửa luồng mẫu:",c.value.id)}async function x(){console.log("Thay đổi trạng thái luồng mẫu:",c.value.id)}function N(){console.log("Xóa luồng mẫu:",c.value.id)}return{isLoading:b,templateData:c,formatDate:g,getDepartmentName:p,goBack:f,handleEdit:T,handleToggleStatus:x,handleDelete:N}}}),R={class:"container card p-3"},X={class:"d-flex justify-content-between align-items-center mb-4"},Q={key:0,class:"text-center my-5 py-5"},U={key:1},G={class:"card shadow-sm mb-4"},J={class:"card-body"},O={class:"row mb-3"},P={class:"col-sm-9"},W={class:"border rounded p-3 bg-light"},Y={class:"row mb-3"},Z={class:"col-sm-9"},ss={class:"border rounded p-3 bg-light",style:{"min-height":"80px"}},es={class:"row"},ts={class:"col-sm-9"},as={class:"d-flex flex-wrap gap-3"},ns={class:"badge bg-primary p-2"},is={class:"badge bg-success p-2"},ls={class:"badge bg-info p-2"},os={class:"card shadow-sm mb-4"},ds={class:"card-body"},rs={class:"workflow-steps"},cs={class:"d-flex justify-content-between align-items-center mb-3"},ms={class:"step-header"},us={class:"badge bg-primary fs-6 px-3 py-2"},ps={key:0,class:"badge bg-warning ms-2"},bs={class:"row"},gs={class:"col-12"},fs={class:"border rounded p-3 bg-white"},vs={class:"d-flex align-items-center"},hs={key:0,class:"text-center mt-3"},ys={class:"d-flex justify-content-center gap-3 pt-4 border-top"};function _s(t,e,y,_,w,b){var g;const l=D("a-button"),c=D("a-icon"),u=D("a-spin");return r(),d("div",R,[s("div",X,[e[2]||(e[2]=s("div",null,[s("h2",{class:"fw-bold"}," Chi tiết luồng phê duyệt mẫu "),s("span",{class:"text-secondary fst-italic"},"Thông tin chi tiết luồng phê duyệt mẫu và các bước phê duyệt")],-1)),s("div",null,[m(l,{type:"primary",onClick:t.goBack,size:"large"},{icon:n(()=>e[0]||(e[0]=[s("i",{class:"bi bi-arrow-left me-2"},null,-1)])),default:n(()=>[e[1]||(e[1]=a(" Quay lại "))]),_:1},8,["onClick"])])]),t.isLoading?(r(),d("div",Q,[m(u,{tip:"Đang tải thông tin..."},{default:n(()=>[m(c,{type:"loading",style:{"font-size":"24px"}})]),_:1})])):(r(),d("div",U,[s("div",G,[e[9]||(e[9]=s("div",{class:"card-header bg-primary text-white"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-info-circle me-2"}),a(" Thông tin luồng mẫu ")])],-1)),s("div",J,[s("div",O,[e[3]||(e[3]=s("div",{class:"col-sm-3 text-start mb-2 mb-sm-0 align-self-center"},[s("label",{class:"form-label fw-semibold"},[s("span",null,"Tên luồng mẫu:")])],-1)),s("div",P,[s("div",W,i(t.templateData.name),1)])]),s("div",Y,[e[4]||(e[4]=s("div",{class:"col-sm-3 text-start mb-2 mb-sm-0 align-self-center"},[s("label",{class:"form-label fw-semibold"},[s("span",null,"Mô tả luồng:")])],-1)),s("div",Z,[s("div",ss,i(t.templateData.description||"Không có mô tả"),1)])]),s("div",es,[e[8]||(e[8]=s("div",{class:"col-sm-3 text-start mb-2 mb-sm-0 align-self-center"},[s("label",{class:"form-label fw-semibold"},[s("span",null,"Thông tin bổ sung:")])],-1)),s("div",ts,[s("div",as,[s("div",ns,[e[5]||(e[5]=s("i",{class:"bi bi-calendar3 me-1"},null,-1)),a(" Ngày tạo: "+i(t.formatDate(t.templateData.created_at)),1)]),s("div",is,[e[6]||(e[6]=s("i",{class:"bi bi-person me-1"},null,-1)),a(" Người tạo: "+i(((g=t.templateData.created_by)==null?void 0:g.name)||"Không xác định"),1)]),s("div",ls,[e[7]||(e[7]=s("i",{class:"bi bi-layers me-1"},null,-1)),a(" Số cấp duyệt: "+i(t.templateData.process),1)]),s("div",{class:h(["badge",t.templateData.is_active?"bg-success":"bg-warning"]),"p-2":""},[s("i",{class:h(["bi",t.templateData.is_active?"bi-check-circle":"bi-pause-circle"]),"me-1":""},null,2),a(" Trạng thái: "+i(t.templateData.is_active?"Hoạt động":"Tạm dừng"),1)],2)])])])])]),s("div",os,[e[15]||(e[15]=s("div",{class:"card-header bg-success text-white"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-flow-chart me-2"}),a(" Các bước trong luồng phê duyệt ")])],-1)),s("div",ds,[s("div",rs,[(r(!0),d(I,null,K(t.templateData.document_flow_steps,(p,f)=>(r(),d("div",{key:f,class:"step-card mb-4 p-4 border rounded-3 bg-light"},[s("div",cs,[s("div",ms,[s("span",us,[e[10]||(e[10]=s("i",{class:"bi bi-bookmark me-1"},null,-1)),a(" Cấp duyệt "+i(p.step),1)]),p.multichoice?(r(),d("span",ps,e[11]||(e[11]=[s("i",{class:"bi bi-arrows-expand me-1"},null,-1),a(" Song song ")]))):C("",!0)])]),s("div",bs,[s("div",gs,[e[13]||(e[13]=s("label",{class:"form-label fw-semibold text-primary"},[s("i",{class:"bi bi-building me-1"}),a(" Đơn vị phê duyệt: ")],-1)),s("div",fs,[s("div",vs,[e[12]||(e[12]=s("i",{class:"bi bi-building-fill me-2 text-secondary"},null,-1)),s("span",null,i(t.getDepartmentName(p.department_id)),1)])])])]),f<t.templateData.document_flow_steps.length-1?(r(),d("div",hs,e[14]||(e[14]=[s("i",{class:"bi bi-arrow-down fs-3 text-primary"},null,-1)]))):C("",!0)]))),128))])])]),s("div",ys,[m(l,{type:"primary",onClick:t.handleEdit,size:"large",class:"px-4 py-2"},{icon:n(()=>e[16]||(e[16]=[s("i",{class:"bi bi-pencil-square me-2"},null,-1)])),default:n(()=>[e[17]||(e[17]=a(" Chỉnh sửa luồng "))]),_:1},8,["onClick"]),m(l,{type:"primary",class:h([t.templateData.is_active?"bg-warning border-warning":"bg-success border-success","px-4 py-2"]),onClick:t.handleToggleStatus,size:"large"},{icon:n(()=>[s("i",{class:h(["bi me-2",t.templateData.is_active?"bi-pause-circle":"bi-check-circle"])},null,2)]),default:n(()=>[a(" "+i(t.templateData.is_active?"Tạm dừng luồng":"Kích hoạt luồng"),1)]),_:1},8,["class","onClick"]),m(l,{type:"primary",class:"bg-danger border-danger px-4 py-2",onClick:t.handleDelete,size:"large"},{icon:n(()=>e[18]||(e[18]=[s("i",{class:"bi bi-trash me-2"},null,-1)])),default:n(()=>[e[19]||(e[19]=a(" Xóa luồng "))]),_:1},8,["onClick"])])]))])}const Cs=z(H,[["render",_s],["__scopeId","data-v-d79a9db6"]]);export{Cs as default};
