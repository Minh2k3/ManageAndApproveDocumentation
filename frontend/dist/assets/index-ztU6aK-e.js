import{_ as U,e as M,c as y,a as n,F as N,u as O,b as l,d as g,r,J as z,N as d,a1 as I,g as a,i as H,k as S,j as E,H as i,D as G,o as C,G as B}from"./index-DPGnjrLh.js";import{u as F}from"./use-register-DhhiCApn.js";import{_ as Q}from"./logo_tlu-B7rE08lr.js";import{_ as $,a as J}from"./logo_hsv-ByMs8kOD.js";import{H as K}from"./HomeOutlined-tScoS2UD.js";import{M as P}from"./MailOutlined-CwHtHF_M.js";const Y=M({components:{MailOutlined:P,QuestionCircleOutlined:I,HomeOutlined:K},setup(){const o=G(),e=F(),h=a(""),v=a(""),c=a(""),f=a(""),m=a(!1),u=a(null),p=a(null),k=a([]),w=a([]),b=(t,V)=>V.label.toLowerCase().includes(t.toLowerCase());let _=0;const L=()=>{const t=Date.now();t-_>=6666?(_=t,i.info("Vui lòng gửi email yêu cầu thêm phòng ban mới đến địa chỉ ThayDungDepTrai@gmail.com!")):console.log("Thông báo này đang trong thời gian cooldown")};H(async()=>{await e.fetchRegisterForm(),k.value=e.departments,w.value=e.rolls,console.log("Đã gọi hàm getUsersRegister()")});const s=a(!1),T=a(!1),D=()=>{if(console.log("Đăng ký với thông tin:",{name:h.value,email:v.value,password:c.value,password_confirmation:f.value,department_id:u.value,roll_at_department_id:p.value}),!h.value.trim()){i.error("Vui lòng nhập họ và tên!"),s.value=!1;return}if(!v.value.trim()){i.error("Vui lòng nhập email!"),s.value=!1;return}if(u.value===null){i.error("Phòng ban không được để trống."),s.value=!1;return}if(p.value===null){i.error("Vai trò không được để trống."),s.value=!1;return}if(!c.value.trim()){i.error("Mật khẩu không được để trống."),s.value=!1;return}if(c.value!==f.value){i.error("Mật khẩu không khớp!"),s.value=!1;return}if(!m.value){i.error("Vui lòng đồng ý với các điều khoản và chính sách của hệ thống!"),s.value=!1;return}s.value=!0,T.value=!0};S(s,async t=>{t&&(console.log("Đăng ký người dùng mới"),await R(),s.value=!1)});const R=async()=>{console.log("Đăng ký người dùng mới");try{const t=await B.post("api/register",{name:h.value,email:v.value,password:c.value,password_confirmation:f.value,department_id:u.value,roll_at_department_id:p.value});console.log("Đăng ký thành công:",t.data),s.value=!1,i.success("Đăng ký thành công! Vui lòng kiểm tra email để xác nhận tài khoản."),o.push({name:"login"})}catch(t){t.response&&t.response.status===422?(console.log("Lỗi validate:",t.response.data.errors),alert("Đăng ký thất bại: "+JSON.stringify(t.response.data.errors))):(console.error("Lỗi khác:",t),i.error("Đăng ký thất bại: "+JSON.stringify(t.response.data.message)))}finally{T.value=!1}},q=t=>{t.key==="Enter"&&D()};return H(()=>{document.addEventListener("keydown",q)}),E(()=>{document.removeEventListener("keydown",q)}),{name:h,email:v,password:c,password_confirmation:f,departments:k,rolls:w,ok:m,selectedDepartment:u,selectedRoll:p,loading:T,filterOption:b,showRequestNewDepartmentModal:L,register:D,handleClickLogoTlu:()=>{window.open("https://tlu.edu.vn","_blank")},handleClickLogoDtn:()=>{window.open("https://www.facebook.com/doanthanhnienTLU","_blank")},handleClickLogoHsv:()=>{window.open("https://www.facebook.com/HSVDHTL","_blank")}}}}),j={class:"register-container"},X={class:"particles"},A={class:"main-content"},W={class:"left-side"},Z={class:"logo-section fade-in-left"},x={class:"logos-container"},ee={class:"right-side"},ne={class:"form-container fade-in-right"},se={class:"form-row"},oe={class:"form-group half-width"},te={class:"form-group half-width"},le={class:"form-row"},ae={class:"form-group department-width"},ie={class:"department-input"},re={class:"form-group role-width"},de={class:"form-row"},ue={class:"form-group half-width"},pe={class:"form-group half-width"},ce={class:"terms-section"},me={class:"terms-checkbox"},ge=["disabled"],he={key:0},ve={key:1},fe={class:"login-link"};function ke(o,e,h,v,c,f){const m=r("a-avatar"),u=r("a-input"),p=r("a-select"),k=r("QuestionCircleOutlined"),w=r("a-tooltip"),b=r("a-input-password"),_=r("a-checkbox"),L=r("router-link");return C(),y("div",j,[n("div",X,[(C(),y(N,null,O(50,s=>n("div",{class:"particle",key:s})),64))]),n("div",A,[n("div",W,[n("div",Z,[n("div",x,[l(m,{type:"button",onClick:o.handleClickLogoTlu,shape:"square",size:60,class:"logo-item"},{icon:g(()=>e[9]||(e[9]=[n("img",{src:Q,alt:"logo_tlu"},null,-1)])),_:1},8,["onClick"]),l(m,{type:"button",onClick:o.handleClickLogoDtn,shape:"square",size:60,class:"logo-item"},{icon:g(()=>e[10]||(e[10]=[n("img",{src:$,alt:"logo_dtn"},null,-1)])),_:1},8,["onClick"]),l(m,{type:"button",onClick:o.handleClickLogoHsv,shape:"square",size:55,class:"logo-item"},{icon:g(()=>e[11]||(e[11]=[n("img",{src:J,alt:"logo_hsv"},null,-1)])),_:1},8,["onClick"])]),e[12]||(e[12]=n("div",{class:"title-section"},[n("h2",{class:"university-name"},"TRƯỜNG ĐẠI HỌC THỦY LỢI"),n("h3",{class:"department-name"},"Đoàn Thanh niên - Hội Sinh viên")],-1))]),e[13]||(e[13]=n("div",{class:"system-title fade-in-up"},[n("h1",null,[n("span",null," Hệ Thống Quản Lý và "),n("br"),n("span",null," Phê Duyệt Văn Bản Điện Tử ")])],-1))]),n("div",ee,[n("div",ne,[e[25]||(e[25]=n("div",{class:"form-header"},[n("h1",{class:"register-title"},"ĐĂNG KÝ"),n("p",{class:"register-subtitle"},"Tạo tài khoản mới để sử dụng hệ thống")],-1)),n("form",{onSubmit:e[8]||(e[8]=z((...s)=>o.register&&o.register(...s),["prevent"])),class:"register-form"},[n("div",se,[n("div",oe,[e[14]||(e[14]=n("label",null,[n("span",{class:"required"},"*"),d(" Họ và tên ")],-1)),l(u,{value:o.name,"onUpdate:value":e[0]||(e[0]=s=>o.name=s),placeholder:"Trần Tuấn Minh","allow-clear":"",size:"large",class:"form-input"},null,8,["value"])]),n("div",te,[e[15]||(e[15]=n("label",null,[n("span",{class:"required"},"*"),d(" Email ")],-1)),l(u,{value:o.email,"onUpdate:value":e[1]||(e[1]=s=>o.email=s),placeholder:"2151062831@e.tlu.edu.vn","allow-clear":"",size:"large",class:"form-input"},null,8,["value"])])]),n("div",le,[n("div",ae,[e[16]||(e[16]=n("label",null,[n("span",{class:"required"},"*"),d(" Phòng/Khoa/Đơn vị ")],-1)),n("div",ie,[l(p,{value:o.selectedDepartment,"onUpdate:value":e[2]||(e[2]=s=>o.selectedDepartment=s),"show-search":"",placeholder:"Chọn phòng/khoa/đơn vị",style:{width:"100%"},options:o.departments,"filter-option":o.filterOption,"allow-clear":"",size:"large","dropdown-match-select-width":!1,"list-height":200},null,8,["value","options","filter-option"]),l(w,{placement:"right",title:"Đơn vị của bạn không có trong danh sách? Gửi mail cho admin bằng tài khoản outlook của trường"},{default:g(()=>[l(k,{class:"question-icon",onClick:o.showRequestNewDepartmentModal},null,8,["onClick"])]),_:1})])]),n("div",re,[e[17]||(e[17]=n("label",null,[n("span",{class:"required"},"*"),d(" Vai trò ")],-1)),l(p,{value:o.selectedRoll,"onUpdate:value":e[3]||(e[3]=s=>o.selectedRoll=s),"show-search":"",placeholder:"Chọn vai trò",style:{width:"100%"},options:o.rolls,"filter-option":o.filterOption,"allow-clear":"",size:"large","dropdown-match-select-width":!1,"list-height":200},null,8,["value","options","filter-option"])])]),n("div",de,[n("div",ue,[e[18]||(e[18]=n("label",null,[n("span",{class:"required"},"*"),d(" Mật khẩu ")],-1)),l(b,{value:o.password,"onUpdate:value":e[4]||(e[4]=s=>o.password=s),placeholder:"abcILoveYou123","allow-clear":"",size:"large",class:"form-input"},null,8,["value"])]),n("div",pe,[e[19]||(e[19]=n("label",null,[n("span",{class:"required"},"*"),d(" Xác nhận mật khẩu ")],-1)),l(b,{value:o.password_confirmation,"onUpdate:value":e[5]||(e[5]=s=>o.password_confirmation=s),placeholder:"abcILoveYou123","allow-clear":"",size:"large",class:"form-input"},null,8,["value"])])]),n("div",ce,[n("div",me,[l(_,{checked:o.ok,"onUpdate:checked":e[6]||(e[6]=s=>o.ok=s),class:"custom-checkbox"},{default:g(()=>e[20]||(e[20]=[n("span",{class:"terms-text"}," Tôi đồng ý với các điều khoản và chính sách của hệ thống ",-1)])),_:1},8,["checked"])]),e[21]||(e[21]=n("div",{class:"terms-link"},[n("span",{class:"text-secondary"},"Chi tiết điều khoản xem "),n("a",{href:"#",class:"link-primary"},"tại đây")],-1))]),n("button",{type:"button",class:"register-btn",disabled:o.loading,onClick:e[7]||(e[7]=(...s)=>o.register&&o.register(...s))},[o.loading?(C(),y("span",he,e[22]||(e[22]=[n("i",{class:"spinner-border spinner-border-sm me-2"},null,-1),d(" Đang đăng ký... ")]))):(C(),y("span",ve,"Đăng ký"))],8,ge)],32),n("div",fe,[e[24]||(e[24]=n("span",null,"Đã có tài khoản?",-1)),l(L,{to:{name:"login"}},{default:g(()=>e[23]||(e[23]=[d(" Đăng nhập ngay ")])),_:1})])])])])])}const He=U(Y,[["render",ke],["__scopeId","data-v-d8f74a82"]]);export{He as default};
