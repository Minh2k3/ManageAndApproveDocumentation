import{_ as I,e as E,c as w,a as n,b as t,F as N,u as G,d as l,r as u,p as U,J as D,n as $,N as v,z as q,g as i,k as S,i as B,j as O,H as p,m as Q,G as b,D as R,o as y}from"./index-HU749lUt.js";import{_ as Y}from"./logo_tlu-B7rE08lr.js";import{_ as j,a as A}from"./logo_hsv-ByMs8kOD.js";import{H as P}from"./HomeOutlined-zuC_99WE.js";import{M}from"./MailOutlined-BnwLs6Bd.js";const J=E({components:{MailOutlined:M,HomeOutlined:P},setup(){const e=R(),o=q(),f=i(""),k=i(""),C=i(!1),H=i(""),r=i(""),m=i(null),d=i(!1),g=i(!1),F=i(!1),c=()=>{if(f.value===""||k.value===""){p.error("Vui lòng nhập đầy đủ thông tin!"),d.value=!1;return}d.value=!0,g.value=!0};S(d,async a=>{a&&(console.log("Form đã xác thực ở phía frontend."),await L(),d.value=!1)});const L=async()=>{await b.get("/sanctum/csrf-cookie");try{const a=await o.login({email:f.value,password:k.value,remember:C.value});a.status==="error"&&p.error(a.message),d.value=!1;const _=await b.get("api/user",{withCredentials:!0});p.success("Đăng nhập thành công!"),console.log("Thông tin người dùng:",_.data);const z=_.data;console.log(z.id),e.push({name:o.role})}catch(a){console.error("Login error:",a)}finally{g.value=!1}},s=a=>{a.key==="Enter"&&(h.value?T():c())};B(()=>{document.addEventListener("keydown",s)}),O(()=>{document.removeEventListener("keydown",s)});const h=i(!1),V=async()=>{h.value=!0,r.value="",await Q(),m.value.focus()},T=async()=>{if(!r.value){p.error("Vui lòng nhập email của bạn.");return}try{await b.get("/sanctum/csrf-cookie");const a=await b.post("/api/forgot-password",{email:r.value});p.success("Yêu cầu quên mật khẩu đã được gửi. Vui lòng kiểm tra email của bạn."),h.value=!1}catch{p.error("Đã xảy ra lỗi khi gửi yêu cầu quên mật khẩu.")}};return{email:f,password:k,rememberMe:C,firstFieldError:H,emailForgot:r,emailForgotInput:m,HomeOutlined:P,MailOutlined:M,loading:g,pageLoading:F,modalForgotPassword:h,openModalForgotPassword:V,handleForgotPassword:T,login:c,handleClickLogoTlu:()=>{window.open("https://tlu.edu.vn","_blank")},handleClickLogoDtn:()=>{window.open("https://www.facebook.com/doanthanhnienTLU","_blank")},handleClickLogoHsv:()=>{window.open("https://www.facebook.com/HSVDHTL","_blank")}}}}),K={class:"login-container"},W={class:"particles"},X={class:"main-content"},Z={class:"left-side"},x={class:"logo-section fade-in-left"},oo={class:"logos-container"},no={class:"right-side"},eo={class:"form-container fade-in-right"},so={class:"form-group"},to={class:"form-group"},ao={class:"form-options"},lo=["disabled"],io={key:0},ro={key:1},uo={class:"register-link"},po={class:"modal-content"};function mo(e,o,f,k,C,H){const r=u("a-avatar"),m=u("a-input"),d=u("a-input-password"),g=u("a-checkbox"),F=u("router-link"),c=u("a-button"),L=u("a-modal");return y(),w(N,null,[n("div",K,[n("div",W,[(y(),w(N,null,G(50,s=>n("div",{class:"particle",key:s})),64))]),n("div",X,[n("div",Z,[n("div",x,[n("div",oo,[t(r,{type:"button",onClick:e.handleClickLogoTlu,shape:"square",size:60,class:"logo-item"},{icon:l(()=>o[9]||(o[9]=[n("img",{src:Y,alt:"logo_tlu"},null,-1)])),_:1},8,["onClick"]),t(r,{type:"button",onClick:e.handleClickLogoDtn,shape:"square",size:60,class:"logo-item"},{icon:l(()=>o[10]||(o[10]=[n("img",{src:j,alt:"logo_dtn"},null,-1)])),_:1},8,["onClick"]),t(r,{type:"button",onClick:e.handleClickLogoHsv,shape:"square",size:55,class:"logo-item"},{icon:l(()=>o[11]||(o[11]=[n("img",{src:A,alt:"logo_hsv"},null,-1)])),_:1},8,["onClick"])]),o[12]||(o[12]=n("div",{class:"title-section"},[n("h2",{class:"university-name"},"TRƯỜNG ĐẠI HỌC THỦY LỢI"),n("h3",{class:"department-name"},"Đoàn Thanh niên - Hội Sinh viên")],-1))]),o[13]||(o[13]=n("div",{class:"system-title fade-in-up"},[n("h1",null,[n("span",null," Hệ Thống Quản Lý và "),n("br"),n("span",null," Phê Duyệt Văn Bản Điện Tử ")])],-1))]),n("div",no,[n("div",eo,[o[20]||(o[20]=U('<div class="form-header" data-v-0335e6e7><h1 class="login-title" data-v-0335e6e7>ĐĂNG NHẬP</h1><p class="login-subtitle" data-v-0335e6e7>Nhập thông tin để truy cập hệ thống</p></div><div class="outlook-login" data-v-0335e6e7><button class="outlook-btn" data-v-0335e6e7><i class="bi bi-envelope me-2" data-v-0335e6e7></i> Đăng nhập với Outlook </button></div><div class="divider" data-v-0335e6e7><span data-v-0335e6e7>HOẶC ĐĂNG NHẬP VỚI</span></div>',3)),n("form",{onSubmit:o[5]||(o[5]=D((...s)=>e.login&&e.login(...s),["prevent"])),class:"login-form"},[n("div",so,[o[14]||(o[14]=n("label",null,"Email",-1)),t(m,{value:e.email,"onUpdate:value":o[0]||(o[0]=s=>e.email=s),placeholder:"2151062831@e.tlu.edu.vn","allow-clear":"",size:"large",class:$(["form-input",{"input-danger":e.firstFieldError==="email"}])},null,8,["value","class"])]),n("div",to,[o[15]||(o[15]=n("label",null,"Mật khẩu",-1)),t(d,{value:e.password,"onUpdate:value":o[1]||(o[1]=s=>e.password=s),placeholder:"abcILoveYou123","allow-clear":"",size:"large",class:"form-input"},null,8,["value"])]),n("div",ao,[t(g,{checked:e.rememberMe,"onUpdate:checked":o[2]||(o[2]=s=>e.rememberMe=s)},{default:l(()=>o[16]||(o[16]=[v("Ghi nhớ đăng nhập")])),_:1},8,["checked"]),n("a",{href:"#",class:"forgot-link",onClick:o[3]||(o[3]=(...s)=>e.openModalForgotPassword&&e.openModalForgotPassword(...s))}," Quên mật khẩu? ")]),n("button",{type:"button",class:"login-btn",disabled:e.loading,onClick:o[4]||(o[4]=(...s)=>e.login&&e.login(...s))},[e.loading?(y(),w("span",io,o[17]||(o[17]=[n("i",{class:"spinner-border spinner-border-sm me-2"},null,-1),v(" Đang đăng nhập... ")]))):(y(),w("span",ro,"Đăng nhập"))],8,lo)],32),n("div",uo,[o[19]||(o[19]=n("span",null,"Chưa có tài khoản?",-1)),t(F,{to:{name:"register"}},{default:l(()=>o[18]||(o[18]=[v(" Đăng ký ngay ")])),_:1})])])])])]),t(L,{open:e.modalForgotPassword,onCancel:o[8]||(o[8]=s=>e.modalForgotPassword=!1),class:"forgot-modal"},{title:l(()=>o[21]||(o[21]=[n("span",{class:"modal-title"},"Quên mật khẩu",-1)])),footer:l(()=>[t(c,{onClick:o[7]||(o[7]=s=>e.modalForgotPassword=!1)},{default:l(()=>o[23]||(o[23]=[v("Đóng")])),_:1}),t(c,{type:"primary",onClick:e.handleForgotPassword},{default:l(()=>o[24]||(o[24]=[v(" Gửi yêu cầu ")])),_:1},8,["onClick"])]),default:l(()=>[n("div",po,[o[22]||(o[22]=n("p",null,"Vui lòng điền email đã đăng ký để khôi phục mật khẩu.",-1)),t(m,{value:e.emailForgot,"onUpdate:value":o[6]||(o[6]=s=>e.emailForgot=s),placeholder:"Nhập email của bạn","allow-clear":"",size:"large",ref:"emailForgotInput"},null,8,["value"])])]),_:1},8,["open"])],64)}const yo=I(J,[["render",mo],["__scopeId","data-v-0335e6e7"]]);export{yo as default};
