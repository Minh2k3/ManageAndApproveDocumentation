import{u as B}from"./use-menu-CIRKYwAT.js";import{_ as V,d as j,c as i,a as r,w as u,r as y,F as C,L as $,x as A,u as I,e as k,f as L,o as a,b as e,D as d,A as O,l as p,J as _}from"./index-Ba8l0gpi.js";import"./pdfjs-CqkleIqs.js";const R=j({components:{EyeOutlined:$},setup(){B().onSelectedKeys(["admin-documents"]);const s=A(),t=I(),h=k([]),b=k([]),N=k([]);L(async()=>{b.value=s.documents,N.value=s.document_types,h.value=t.users});const D=k(!1),g=k({}),v=o=>{g.value=o,D.value=!0,console.log(g.value.id)};return{users:h,documents:b,columns:[{title:"Tên văn bản",key:"title",dataIndex:"title",width:200,sorter:(o,l)=>o.title.localeCompare(l.title),sortDirections:["ascend","descend"],customHeaderCell:()=>({style:{textAlign:"center"}})},{title:"Loại văn bản",key:"type",dataIndex:"type",width:150,sorter:(o,l)=>o.type.localeCompare(l.type),sortDirections:["ascend","descend"],customHeaderCell:()=>({style:{textAlign:"center"}})},{title:"Người đề xuất",key:"creator_name",dataIndex:"creator_name",width:200,sorter:(o,l)=>o.creator_name.localeCompare(l.creator_name),sortDirections:["ascend","descend"],align:"center"},{title:"Trạng thái",key:"status",dataIndex:"status",width:120,sorter:(o,l)=>{const c={draft:1,in_review:2,approved:3,rejected:4};return c[o.status]-c[l.status]},sortDirections:["ascend","descend"],align:"center"},{title:"Ngày tạo",key:"created_at",dataIndex:"created_at",width:150,sorter:(o,l)=>{const c=o.created_at.split(" ")[1].split("/").reverse().join("-")+" "+o.created_at.split(" ")[0],w=l.created_at.split(" ")[1].split("/").reverse().join("-")+" "+l.created_at.split(" ")[0];return c.localeCompare(w)},sortDirections:["ascend","descend"],align:"center"},{title:"Ngày cập nhật",key:"updated_at",dataIndex:"updated_at",width:150,sorter:(o,l)=>{const c=o.updated_at.split(" ")[1].split("/").reverse().join("-")+" "+o.updated_at.split(" ")[0],w=l.updated_at.split(" ")[1].split("/").reverse().join("-")+" "+l.updated_at.split(" ")[0];return c.localeCompare(w)},sortDirections:["ascend","descend"],align:"center"}],detailVisible:D,selectedDocument:g,customRow:o=>({onClick:()=>{v(o)},style:{cursor:"pointer"}}),viewDetail:v}}}),U={class:"row mb-3"},E={class:"col-12"},M={class:"row g-2"},F={class:"col-12 col-md-4"},H={class:"col-12 col-md-8"},J={class:"row g-2"},K={class:"col-6 col-md-3"},P={class:"col-6 col-md-3"},Q={class:"col-6 col-md-3"},X={class:"col-6 col-md-1 d-flex align-items-center justify-content-end"},q={class:"row"},z={class:"col-12"},G={key:0},W={class:""},Y={key:2},Z={key:0,class:"text-secondary"},x={key:1,class:"text-primary"},tt={key:2,class:"text-success"},et={key:3,class:"text-danger"},st={key:4},ot={key:0},nt={key:1},lt={key:2},at={key:3},it=["href"];function dt(s,t,h,b,N,D){const g=y("a-input-search"),v=y("a-select"),f=y("a-button"),S=y("a-tooltip"),o=y("a-table"),l=y("a-card"),c=y("a-divider"),w=y("a-modal");return a(),i(C,null,[r(l,{title:"",style:{width:"100%"}},{default:u(()=>[t[9]||(t[9]=e("h2",{class:"fw-bold mb-3"},"Quản Lý Văn Bản",-1)),e("div",U,[e("div",E,[e("div",M,[e("div",F,[r(g,{placeholder:"Tìm kiếm","allow-clear":"","enter-button":"",class:"w-100"})]),e("div",H,[e("div",J,[e("div",K,[r(v,{value:s.status_id,"onUpdate:value":t[0]||(t[0]=n=>s.status_id=n),"show-search":"",placeholder:"Trạng thái",options:s.documents_status,"filter-option":s.filterOption,"allow-clear":"",class:"w-100"},null,8,["value","options","filter-option"])]),e("div",P,[r(v,{value:s.type_id,"onUpdate:value":t[1]||(t[1]=n=>s.type_id=n),"show-search":"",placeholder:"Loại văn bản",options:s.documents_type,"filter-option":s.filterOption,"allow-clear":"",class:"w-100"},null,8,["value","options","filter-option"])]),e("div",Q,[r(v,{value:s.department_id,"onUpdate:value":t[2]||(t[2]=n=>s.department_id=n),"show-search":"",placeholder:"Đơn vị đề xuất",options:s.documents_creator,"filter-option":s.filterOption,"allow-clear":"",class:"w-100"},null,8,["value","options","filter-option"])]),e("div",X,[r(f,{type:"primary",class:"w-100 w-md-auto"},{default:u(()=>t[6]||(t[6]=[e("i",{class:"fa-solid fa-filter"},null,-1)])),_:1})])])])])])]),e("div",q,[e("div",z,[r(o,{dataSource:s.documents,columns:s.columns,scroll:{x:576},bordered:"",customRow:s.customRow,showSorterTooltip:!1,locale:{triggerDesc:"Nhấn để sắp xếp giảm dần",triggerAsc:"Nhấn để sắp xếp tăng dần",cancelSort:"Nhấn để hủy sắp xếp"}},{bodyCell:u(({column:n,index:T,record:m})=>[n.key==="index"?(a(),i("span",G,p(T+1),1)):d("",!0),n.key==="creator_name"?(a(),O(S,{key:1},{title:u(()=>[e("span",W,p(m.roll),1)]),default:u(()=>[e("span",null,p(m.creator_name),1)]),_:2},1024)):d("",!0),n.key==="type"?(a(),i("span",Y,p(m.type),1)):d("",!0),n.key==="status"?(a(),i(C,{key:3},[m.status==="draft"?(a(),i("span",Z,"Bản nháp")):d("",!0),m.status==="in_review"?(a(),i("span",x,"Chờ duyệt")):d("",!0),m.status==="approved"?(a(),i("span",tt,"Đã duyệt")):d("",!0),m.status==="rejected"?(a(),i("span",et,"Bị từ chối")):d("",!0)],64)):d("",!0),n.key==="created_at"?(a(),i("span",st,p(m.created_at),1)):d("",!0),n.key==="action"?(a(),i(C,{key:5},[r(f,{class:"btn border"},{default:u(()=>t[7]||(t[7]=[e("i",{class:"bi bi-eye"},null,-1)])),_:1}),r(f,{class:"btn border"},{default:u(()=>t[8]||(t[8]=[e("i",{class:"bi bi-eye"},null,-1)])),_:1})],64)):d("",!0)]),_:1},8,["dataSource","columns","customRow"])])])]),_:1}),r(w,{visible:s.detailVisible,"onUpdate:visible":t[5]||(t[5]=n=>s.detailVisible=n),title:"Chi tiết văn bản",width:"600px"},{footer:u(()=>[r(f,{onClick:t[3]||(t[3]=n=>s.detailVisible=!1)},{default:u(()=>t[19]||(t[19]=[_("Đóng")])),_:1}),r(f,{type:"primary",onClick:t[4]||(t[4]=n=>s.goToEditPage(s.selectedDocument.id))},{default:u(()=>t[20]||(t[20]=[_("Sửa")])),_:1})]),default:u(()=>[e("div",null,[t[18]||(t[18]=e("h5",null,"📄 Thông tin văn bản",-1)),e("p",null,[t[10]||(t[10]=e("strong",null,"Tiêu đề:",-1)),_(" "+p(s.selectedDocument.title),1)]),e("p",null,[t[11]||(t[11]=e("strong",null,"Mô tả:",-1)),_(" "+p(s.selectedDocument.description),1)]),e("p",null,[t[12]||(t[12]=e("strong",null,"Loại văn bản:",-1)),_(" "+p(s.selectedDocument.type),1)]),e("p",null,[t[13]||(t[13]=e("strong",null,"Người đề xuất:",-1)),_(" "+p(s.selectedDocument.creator_name),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Trạng thái:",-1)),s.selectedDocument.status=="draft"?(a(),i("span",ot," Nháp")):d("",!0),s.selectedDocument.status=="pending"?(a(),i("span",nt," Chờ phê duyệt")):d("",!0),s.selectedDocument.status=="approved"?(a(),i("span",lt," Đã phê duyệt")):d("",!0),s.selectedDocument.status=="rejected"?(a(),i("span",at," Bị từ chối")):d("",!0)]),e("p",null,[t[15]||(t[15]=e("strong",null,"Ngày tạo:",-1)),_(" "+p(s.selectedDocument.created_at),1)]),e("p",null,[t[16]||(t[16]=e("strong",null,"Ngày cập nhật:",-1)),_(" "+p(s.selectedDocument.updated_at),1)]),e("p",null,[t[17]||(t[17]=e("strong",null,"Tệp:",-1)),e("a",{href:`http://localhost:8000/documents/${s.selectedDocument.file_path}`,target:"_blank"}," Xem tệp ",8,it)]),r(c)])]),_:1},8,["visible"])],64)}const ct=V(R,[["render",dt]]);export{ct as default};
